This SQL query runs slowly <(>30 seconds)>:

[paste query]

Table sizes:
- orders: 10M rows
- customers: 500K rows
- products: 50K rows

Suggest optimizations:
- Query restructuring
- Index recommendations
- Execution plan analysis